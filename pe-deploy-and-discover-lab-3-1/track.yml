slug: pe-deploy-and-discover-lab-3-1
id: v3t0yr1nxnqr
type: sandbox
title: 'PE Deploy and Discover - Lab 3.1: Identify Server Roles by Using Package Data Collection'
teaser: Use the package data that you collect to identify the roles of the servers in your environment.
description: |-
  # We're putting the finishing touches on this BETA Puppet Practice Lab — go ahead and take a peek!

  Please help us find any bugs that need to be zapped and share your feedback for improving this learning experience by clicking the Bug Zapper tab at the top of each challenge and completing the short survey.

  Thank you for your help. We welcome your suggestions and value your feedback. If you have additional comments or suggestions after completing this BETA Puppet Practice Lab, please [reach out to us directly](mailto:education@puppet.com). We want to hear from you.
  ___

  **What you'll learn**

  In this lab, you'll learn how to enable the package data collection feature via the PE console to discover which packages are installed across your systems. Then, you will use this information to identify the roles of the servers in your environment (web server, database server, and so on).

  When you know which packages are installed on your systems:
  - You can identify which nodes are impacted by packages you know are eligible for maintenance updates, security patches, and license renewals.
  - You can define a **role** fact to group nodes and collect configuration and performance data about a specific node group.

  **Prerequisites**

  This lab builds on activities from other PE Deploy and Discover labs. Make sure that you have completed:
  - [Lab 3.0: Identify Information About Your Nodes By Using facter_task & External Facts](https://play.instruqt.com/puppet/invite/7njh4szvazdy)

  **Before you start**

  Keep an eye on the clock. You have 30 minutes to complete this lab. After 30 minutes, your learning environment expires and your work will not be saved. If you haven't completed the lab, you can simply restart it. Click **Start track** when you're ready to begin.
icon: https://storage.googleapis.com/instruqt-images/bz-smallicon-1.png
tags: []
owner: puppet
developers:
- greg.larkin@puppet.com
- thomas.chisholm@puppet.com
- tara.swenson@puppet.com
- catherine.trinkwon@puppet.com
private: true
published: true
show_timer: true
challenges:
- slug: working-with-the-package-data-collector
  id: kcnxqq8o1o5d
  type: challenge
  title: View and manage packages
  teaser: Enable package collection and view the package collection report.
  notes:
  - type: text
    contents: |-
      ## Scenario

      Your team lead has given you the following list of packages and notes about the roles of the servers that have those packages installed:

      <img src="https://storage.googleapis.com/instruqt-images/PE-deploy-and-discover/lab-3.1-scenario-img.png">

      Click the arrow to the right (**>**) to continue.
  - type: text
    contents: |-
      Your team lead wants you to generate reports that show:

      - Which packages are installed on all the nodes in your environment.
      - Which nodes are web servers. From the documentation your team lead gave you, you know that web servers have the **httpd** package installed.

      To complete these tasks, you'll enable package data collection and run Puppet to collect the data. Then, you'll view the package output in the console and generate reports.

      When you know which nodes fulfill which roles, you could also define a **role** fact to group and count servers based on their functional role. You could use this information to collect configuration and performance data about a specific node group (but you won't do that in this lab).

      Click the arrow to the right (**>**) to continue.
  - type: text
    contents: |-
      By default, package data collection is disabled, so the Packages page in the PE console doesn't show any data.

      You can choose to collect package data on all your nodes or just a subset. Any node with an agent version 1.6.0 or later installed can report package data, including nodes that do not have active configurations defined on the primary server.

      This lab takes about 5 minutes to spin up. When the **Start** button appears, click it to begin.
  assignment: |-
    ## Enable package data collection
    1. On the **PE Console** tab, log in to the console with username `admin` and password `puppetlabs`.

    2. From the console sidebar, navigate to the **Node groups** page, expand (click **+**) **PE Infrastructure**, and click the **PE Agent** node group.

    3. On the **Classes** tab, notice that the `puppet_enterprise::profile::agent` class has already been added to this node group, along with a couple of class-specific parameters.

    4. In the **Parameter name** list for the class, select the `package_inventory_enabled` parameter and set it to `true`. Then, click **Add to node group** and commit your change by clicking **Commit** near the bottom of the page.

    5. Run Puppet to apply the change to the nodes in the **PE Agent** node group: Click **Run > Puppet** near the upper-right corner of the page. Notice the node details, and leave the options with the default values shown. Then, click **Run job** near the bottom of the page. This might take a few moments to complete (monitor the job status near the upper-right corner of the page).

    ✏️ Note: If you navigate away from the **Job details** page before the job completes, you can go back by going to the **Jobs** page and clicking the most recent job.

    On this Puppet run, Puppet enables package inventory collection. On subsequent Puppet runs, Puppet collects package data and reports it on the **Packages** page.

    6. To start collecting and reporting package data, run Puppet a second time. In the upper right of the **Job details** page, click **Run again > All nodes**. Leave the default options as before and click **Run job** to start the second Puppet agent run. You can see the job status near the upper-right corner of the page.

    ## View and manage package inventory

    1. To view and manage the complete inventory of packages on your systems, go to the **Packages** page.

    2. For this scenario, you're trying to find the app and web servers and load balancers by searching for the packages listed in the table below: Enter the name or partial name of a package in the **Filter by package name** field and click **Apply**. In the results list, click the package name, and notice which nodes have the package installed. Repeat this step for all the packages in the table.

    | Package Name        | Server Role   |
    |---------------------|---------------|
    | Java 8              | App server    |
    | httpd               | Web server    |
    | nginx               | Load balancer |


    ## Create a report that shows all the packages installed in your environment
    1. On the **Packages** page, remove any filters from the previous steps. Then, right-click **Export Data** and click **Save link as**.
    2. Download the CSV file to your local machine and review it.

    ## Create a report that lists the web servers (nodes that have the **httpd** package installed)
    1. On the **Packages** page, in the **Filter by package name** field, enter **httpd** and click **Apply**.
    2. In the results, click **httpd**.
    3. Right-click **Export Data**, and then click **Save link as**. Download and review the CSV file.

    **Congratulations!** You enable package data collection and used the information to discover the roles of the nodes in your environment.

    **Find bugs or have feedback? Click the Bug Zapper tab near the top of the page and let us know!**

    To close this lab, click **Next**.
  tabs:
  - title: PE Console
    type: service
    hostname: puppet
    path: /
    port: 443
  - title: "Bug Zapper \U0001F99F⚡"
    type: website
    hostname: guac
    url: https://docs.google.com/forms/d/e/1FAIpQLSenGFM2AnTNFEGm4K6WLkDE4XlQy5yggQtaatGPPYclkYmmlw/viewform?embedded=true
  difficulty: basic
  timelimit: 1800
checksum: "6336245207158007887"
